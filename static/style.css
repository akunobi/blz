/* =========================================
   VARIABLES DE FUSIÓN
   ========================================= */
:root {
    /* Blue Lock Palette */
    --neon-cyan: #00fff2;
    --deep-blue: #0a0a2a;
    --cyber-grid: rgba(0, 255, 242, 0.15);
    
    /* Naruto/Kurama Palette */
    --neon-orange: #ff6a00;
    --blood-red: #ff003c;
    --chakra-fire: rgba(255, 106, 0, 0.2);
    
    /* Bases */
    --void-black: #020204;
    --font-tech: 'Courier New', monospace;
    --font-rage: 'Impact', sans-serif;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    background: var(--void-black);
    color: #fff;
    font-family: var(--font-tech);
    height: 100vh;
    overflow: hidden;
    perspective: 1000px; /* Para efectos 3D */
}

/* =========================================
   FONDOS CAÓTICOS ANIMADOS
   ========================================= */
.bg-layer { position: fixed; inset: 0; z-index: -1; }

/* Capa 1: El Chakra de Kurama (Fuego naranja giratorio) */
.kurama-fire {
    background: radial-gradient(circle at 50% 50%, var(--chakra-fire), transparent 70%);
    filter: blur(50px);
    opacity: 0.6;
    animation: chakraPulse 8s ease-in-out infinite alternate;
}
@keyframes chakraPulse { 
    0% { transform: scale(1); opacity: 0.4; } 
    100% { transform: scale(1.2); opacity: 0.7; filter: hue-rotate(-20deg); } 
}

/* Capa 2: La Red Digital de Blue Lock (Hexágonos distorsionados) */
.bluelock-grid {
    background-image: 
        linear-gradient(var(--cyber-grid) 1px, transparent 1px),
        linear-gradient(90deg, var(--cyber-grid) 1px, transparent 1px);
    background-size: 50px 50px;
    background-position: center;
    transform: rotateX(60deg) rotateZ(-20deg) scale(1.5);
    opacity: 0.3;
    z-index: -2;
    animation: gridScroll 20s linear infinite;
}
@keyframes gridScroll { 0% { background-position: 0 0; } 100% { background-position: 100px 100px; } }

/* Capa 3: Glitch Overlay */
.screen-glitch-overlay {
    position: fixed; inset: 0; pointer-events: none; z-index: 999;
    background: repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, rgba(0,0,0,0.1) 2px, transparent 2px, transparent 4px);
    opacity: 0.2;
    animation: flicker 0.1s infinite;
}
@keyframes flicker { 0% { opacity: 0.1; } 50% { opacity: 0.15; } 100% { opacity: 0.1; } }


/* =========================================
   LAYOUT PRINCIPAL "ANTI-NATURAL"
   ========================================= */
.chaos-container {
    height: 100vh;
    display: grid;
    /* Una grilla rota, no estándar */
    grid-template-columns: 1fr 3fr 0.5fr;
    grid-template-rows: 1fr 4fr 1fr;
    gap: 20px;
    padding: 30px;
    transform-style: preserve-3d;
}

/* --- 1. EL SELLO LATERAL (Sidebar) --- */
.chakra-seal-sidebar {
    grid-column: 1 / 2;
    grid-row: 1 / 4;
    /* Forma de polígono irregular, inclinada */
    background: linear-gradient(135deg, rgba(10,10,42,0.9), rgba(0,0,0,0.95));
    border-right: 3px solid var(--neon-orange);
    border-left: 1px solid var(--neon-cyan);
    clip-path: polygon(0 0, 100% 5%, 95% 100%, 5% 95%);
    transform: rotateY(15deg) translateZ(-50px);
    display: flex; flex-direction: column;
    padding: 25px;
    backdrop-filter: blur(10px);
    box-shadow: -20px 0 50px var(--chakra-fire);
}

.seal-header {
    font-family: var(--font-rage);
    font-size: 1.8rem;
    margin-bottom: 30px;
    text-align: center;
    letter-spacing: 2px;
}
.glitch-text { color: var(--neon-cyan); text-shadow: 2px 0 var(--blood-red); animation: textGlitch 0.5s infinite steps(2); }
.burn-text { color: var(--neon-orange); text-shadow: 0 0 15px var(--neon-orange); }
@keyframes textGlitch { 0% { transform: skewX(0deg); } 20% { transform: skewX(-10deg); } 40% { transform: skewX(10deg); } }

.channel-scroll-area { flex: 1; overflow-y: auto; border-top: 1px dashed var(--neon-orange); padding-top: 20px; }

/* Botones de canal como sellos de papel */
.channel-btn {
    width: 100%; padding: 12px; margin-bottom: 8px;
    background: rgba(255, 106, 0, 0.05);
    border: 1px solid var(--neon-orange);
    color: var(--neon-orange);
    font-family: var(--font-tech);
    text-transform: uppercase;
    cursor: pointer;
    clip-path: polygon(5% 0, 100% 0, 95% 100%, 0% 100%);
    transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    text-align: left;
    position: relative;
    overflow: hidden;
}
.channel-btn::before { content: '封'; position: absolute; right: 10px; opacity: 0.2; font-family: serif; }
.channel-btn:hover { background: var(--neon-orange); color: #000; transform: scale(1.05) skewX(-5deg); box-shadow: 0 0 20px var(--neon-orange); }
.channel-btn.active {
    background: var(--neon-cyan); color: #000; border-color: var(--neon-cyan);
    box-shadow: 0 0 30px var(--neon-cyan), inset 0 0 10px #fff;
    animation: activePulse 1s infinite alternate;
}
@keyframes activePulse { from {box-shadow: 0 0 10px var(--neon-cyan);} to {box-shadow: 0 0 30px var(--neon-cyan), 0 0 50px var(--neon-orange);} }

/* --- 2. EL NÚCLEO DEL CAOS (Chat Area) --- */
.chat-core-shard {
    grid-column: 2 / 4;
    grid-row: 1 / 3;
    position: relative;
    /* Forma de cristal roto */
    clip-path: polygon(2% 0%, 98% 5%, 100% 90%, 90% 100%, 0% 95%);
    background: rgba(0, 2, 10, 0.85);
    border: 2px solid var(--neon-cyan);
    box-shadow: 0 0 40px rgba(0, 255, 242, 0.2), inset 0 0 20px rgba(255, 106, 0, 0.1);
    display: flex; flex-direction: column;
    transform: translateZ(20px); /* Flota hacia el usuario */
    backdrop-filter: blur(5px);
    overflow: hidden;
}
/* Efecto de borde quemado animado */
.chat-core-shard::after {
    content: ''; position: absolute; inset: 0;
    border: 4px solid transparent;
    border-image: linear-gradient(45deg, var(--neon-cyan), var(--neon-orange), var(--blood-red)) 1;
    mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor; mask-composite: exclude;
    animation: borderRotate 4s linear infinite;
    pointer-events: none;
}
@keyframes borderRotate { 100% { filter: hue-rotate(360deg); } }

.shard-header { padding: 15px; background: rgba(0, 255, 242, 0.1); color: var(--neon-cyan); font-weight: bold; letter-spacing: 3px; border-bottom: 2px solid var(--blood-red); }

.chat-void-feed { flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; gap: 20px; scrollbar-width: none; }
.empty-void { text-align: center; color: #555; margin: auto; font-size: 1.2rem; }
.kurama-eye-icon { font-size: 4rem; color: var(--neon-orange); animation: eyeGlow 2s infinite alternate; }
@keyframes eyeGlow { from{text-shadow: 0 0 10px var(--neon-orange);} to{text-shadow: 0 0 40px var(--neon-orange), 0 0 80px var(--blood-red);} }

/* Mensajes */
.msg-card {
    background: linear-gradient(90deg, rgba(0,0,0,0.8), rgba(10,10,30,0.4));
    border-left: 4px solid var(--neon-orange);
    padding: 15px;
    position: relative;
    transform: skewX(-5deg); /* Mensajes inclinados */
    transition: 0.3s;
    box-shadow: -5px 5px 15px rgba(0,0,0,0.5);
}
.msg-card:hover { border-left-color: var(--neon-cyan); transform: skewX(-5deg) translateX(10px); background: rgba(0, 255, 242, 0.05); }
.msg-header { color: var(--neon-cyan); display: flex; align-items: center; margin-bottom: 8px; font-family: var(--font-rage); letter-spacing: 1px; }
.msg-avatar { width: 35px; height: 35px; border-radius: 50%; border: 2px solid var(--neon-orange); margin-right: 15px; box-shadow: 0 0 10px var(--neon-orange); }
.msg-body { color: #eee; line-height: 1.5; font-size: 1rem; }
.msg-body a { color: var(--neon-orange); text-decoration: none; border-bottom: 1px dotted var(--neon-orange); }

/* Input Flotante (Injection Port) */
.injection-port {
    position: absolute; /* Flota sobre el chat */
    bottom: 20px; right: -30px; /* Posición anti-natural, sobresale */
    width: 80%;
    height: 60px;
    background: #000;
    display: flex;
    border: 2px solid var(--neon-orange);
    transform: rotate(-2deg); /* Inclinado */
    box-shadow: 10px 10px 0 rgba(255, 106, 0, 0.3);
    z-index: 10;
}
#msg-input {
    flex: 1; background: transparent; border: none; color: var(--neon-cyan); padding: 15px; font-family: var(--font-tech); font-size: 1.1rem;
}
#msg-input::placeholder { color: rgba(0, 255, 242, 0.4); }
#msg-input:focus { outline: none; background: rgba(0, 255, 242, 0.05); }
#send-btn {
    background: var(--neon-orange); color: #000; border: none; padding: 0 30px; font-family: var(--font-rage); font-size: 1.2rem; cursor: pointer;
    clip-path: polygon(20% 0, 100% 0, 100% 100%, 0% 100%); transition: 0.3s;
}
#send-btn:hover { background: var(--blood-red); color: #fff; letter-spacing: 3px; box-shadow: 0 0 30px var(--blood-red); }

/* --- 3. EL DETONADOR (Botón Stats) --- */
.kurama-release-btn {
    grid-column: 3 / 4; grid-row: 3 / 4;
    background: var(--void-black); color: var(--neon-orange);
    border: 3px solid var(--neon-orange);
    font-family: var(--font-rage); cursor: pointer;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    transform: rotate(5deg); /* Inclinado */
    transition: 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    box-shadow: 0 0 20px var(--chakra-fire);
    overflow: hidden; position: relative;
}
.kurama-release-btn::before { /* Efecto de llenado de chakra */
    content: ''; position: absolute; top: 100%; left: 0; width: 100%; height: 100%;
    background: var(--neon-orange); transition: 0.5s; z-index: 0;
}
.kurama-release-btn:hover::before { top: 0; }
.kurama-release-btn:hover { border-color: var(--blood-red); color: #000; transform: rotate(0deg) scale(1.1); box-shadow: 0 0 50px var(--blood-red); }
.btn-glitch { font-size: 1.8rem; z-index: 1; position: relative; text-shadow: 3px 3px 0 var(--blood-red); }
.btn-sub { font-size: 0.8rem; font-family: var(--font-tech); z-index: 1; opacity: 0.7; }


/* =========================================
   4. MODO BESTIA (Drawer de Stats)
   ========================================= */
.beast-mode-drawer {
    position: fixed; inset: 0;
    transform: translateY(100%) scale(0.8); /* Empieza abajo y pequeño */
    opacity: 0; pointer-events: none; transition: 0.6s cubic-bezier(0.77, 0, 0.175, 1);
    z-index: 2000; display: flex; justify-content: center; align-items: center;
}
.beast-mode-drawer.active { transform: translateY(0) scale(1); opacity: 1; pointer-events: all; }

/* Fondo furioso al abrir */
.drawer-background-fx {
    position: absolute; inset: 0;
    background: radial-gradient(circle, var(--blood-red) 0%, #000 80%);
    opacity: 0.9; mix-blend-mode: hard-light; z-index: -1;
    animation: ragePulse 1s infinite alternate;
}
@keyframes ragePulse { from{filter: brightness(1);} to{filter: brightness(1.5) contrast(1.2);} }

.drawer-content-wrapper {
    width: 90%; max-width: 1000px;
    background: rgba(10, 0, 0, 0.9);
    border: 4px solid var(--neon-orange);
    padding: 30px;
    clip-path: polygon(5% 0, 95% 0, 100% 10%, 100% 90%, 95% 100%, 5% 100%, 0 90%, 0 10%);
    box-shadow: 0 0 100px var(--blood-red), inset 0 0 50px var(--neon-orange);
    backdrop-filter: blur(20px);
}

.drawer-header-chaotic { display: flex; justify-content: space-between; margin-bottom: 40px; font-family: var(--font-rage); border-bottom: 3px dashed var(--neon-orange); padding-bottom: 20px; }
.drawer-header-chaotic h2 { font-size: 2.5rem; text-shadow: 0 0 20px var(--neon-orange); }
.close-seal { background: transparent; border: 2px solid var(--neon-orange); color: var(--neon-orange); padding: 10px 20px; cursor: pointer; font-weight: bold; transition: 0.3s; }
.close-seal:hover { background: var(--neon-orange); color: #000; box-shadow: 0 0 30px var(--neon-orange); }

.stats-chaos-grid { display: grid; grid-template-columns: 1fr 0.2fr 1fr; gap: 20px; align-items: center; }

/* Estilos de los clusters de inputs */
.stat-cluster { padding: 20px; background: rgba(0,0,0,0.5); border: 2px solid; transition: 0.3s; }
.stat-cluster:hover { transform: scale(1.05); background: #000; }

/* Cyber Cluster (Blue Lock) */
.cyber-cluster { border-color: var(--neon-cyan); clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%); }
.cyber-title { color: var(--neon-cyan); font-family: var(--font-tech); letter-spacing: 2px; margin-bottom: 20px; text-align: right; }
.hex-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.hex-field input { 
    width: 100%; background: rgba(0, 255, 242, 0.1); border: 1px solid var(--neon-cyan); color: var(--neon-cyan); padding: 10px; text-align: center; font-family: var(--font-tech);
    clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%); /* Forma hexagonal */
}
.hex-field input:focus { background: var(--neon-cyan); color: #000; outline: none; box-shadow: 0 0 20px var(--neon-cyan); }
.hex-field.wide { grid-column: span 2; }

/* Beast Cluster (Kurama) */
.beast-cluster { border-color: var(--neon-orange); clip-path: polygon(0 0, 90% 0, 100% 100%, 10% 100%); }
.beast-title { color: var(--neon-orange); font-family: var(--font-rage); letter-spacing: 2px; margin-bottom: 20px; }
.circle-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
.orb-field input {
    width: 100%; height: 60px; border-radius: 50%; /* Círculos */
    background: rgba(255, 106, 0, 0.1); border: 2px solid var(--neon-orange); color: var(--neon-orange);
    text-align: center; font-size: 1.5rem; font-family: var(--font-rage);
    box-shadow: inset 0 0 20px rgba(255, 106, 0, 0.5);
}
.orb-field input:focus { background: var(--neon-orange); color: #000; box-shadow: 0 0 50px var(--neon-orange), 0 0 100px var(--blood-red); outline: none; }

.chaos-divider { font-family: var(--font-rage); font-size: 3rem; color: #fff; text-shadow: -5px 0 var(--neon-cyan), 5px 0 var(--neon-orange); transform: rotate(-15deg); }

#ui-stats-btn {
    width: 100%; margin-top: 40px; padding: 20px;
    background: linear-gradient(45deg, var(--neon-orange), var(--blood-red));
    border: none; color: #000; font-family: var(--font-rage); font-size: 1.5rem; cursor: pointer;
    clip-path: polygon(0 0, 95% 0, 100% 50%, 95% 100%, 0 100%, 5% 50%);
    transition: 0.3s; position: relative; overflow: hidden;
}
#ui-stats-btn:hover { letter-spacing: 5px; padding: 25px; box-shadow: 0 0 100px var(--blood-red); color: #fff; }
.btn-burn { position: relative; z-index: 2; filter: drop-shadow(0 0 5px #000); }


/* =========================================
   MODAL SHARD (Estilo actualizado)
   ========================================= */
.modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 3000; justify-content: center; align-items: center; backdrop-filter: blur(10px); }
.modal-shard {
    background: #000; border: 3px solid var(--neon-cyan); padding: 20px;
    clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%); /* Forma de cristal */
    box-shadow: 0 0 50px var(--neon-cyan), 0 0 20px var(--neon-orange);
    transform: rotate(-2deg);
}
.modal-actions { display: flex; gap: 20px; margin-top: 20px; }
.shard-btn {
    flex: 1; padding: 15px; border: none; font-family: var(--font-rage); font-size: 1.2rem; cursor: pointer; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0% 100%); transition: 0.3s;
}
.shard-btn.close { background: #333; color: #fff; } .shard-btn.close:hover { background: var(--blood-red); }
.shard-btn.copy { background: var(--neon-cyan); color: #000; } .shard-btn.copy:hover { background: #fff; box-shadow: 0 0 30px #fff; }

/* MEDIA QUERIES PARA MÓVIL (Importante por la estructura loca) */
@media (max-width: 900px) {
    .chaos-container {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto;
        display: flex; flex-direction: column; height: auto; /* En móvil apilamos */
    }
    .chakra-seal-sidebar, .chat-core-shard, .kurama-release-btn {
        grid-column: auto; grid-row: auto; transform: none; clip-path: none; /* Quitamos efectos 3D complejos en móvil */
        border: 2px solid var(--neon-cyan);
    }
    .chakra-seal-sidebar { height: 300px; margin-bottom: 20px; }
    .chat-core-shard { height: 500px; }
    .injection-port { position: relative; bottom: auto; right: auto; width: 100%; transform: none; margin-top: 20px; }
    .stats-chaos-grid { grid-template-columns: 1fr; }
}